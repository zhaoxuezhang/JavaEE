<html>
<head>
  <title>4、单例模式</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601935 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1294"/>
<h1>4、单例模式</h1>

<div>
<span><div><div><span style="font-size: 16pt; font-family: Consolas;">1、定义：所谓类的单例设计模式，就是采取一定的方法保证在整个的软件系统中，对某个类只能存在一个单例模式，并且该类只提供一个取得其对象实例的方法。</span></div><div><span style="font-size: 16pt; font-family: Consolas;">2、单例模式的几种写法：</span></div><ul><li><div><span style="font-size: 16pt;"><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">饿汉式（静态常量）</span></span></div></li><li><div><span style="font-size: 16pt;"><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">饿汉式（静态代码块）</span></span></div></li><li><div><span style="font-size: 16pt; font-family: Consolas;">懒汉式（线程不安全）</span></div></li><li><div><span style="font-size: 16pt; font-family: Consolas;">懒汉式（线程安全，同步方法）</span></div></li><li><div><span style="font-size: 16pt; font-family: Consolas;">懒汉式（线程不安全，同步代码块）</span></div></li><li><div><span style="font-size: 16pt;"><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">双重检查</span></span></div></li><li><div><span style="font-size: 16pt;"><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">静态内部类</span></span></div></li><li><div><span style="font-size: 16pt;"><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">枚举</span></span></div></li></ul><hr/><div><font style="font-size: 16pt;"><br/></font></div><div><font style="font-size: 16pt;"><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">（1）饿汉式（静态常量）：</span></font></div><div><span style="font-size: 16pt; font-family: Consolas;">步骤如下：</span></div><ul><li><div><span style="font-size: 16pt; font-family: Consolas;">构造器私有化（防止new）</span></div></li><li><div><span style="font-size: 16pt; font-family: Consolas;">类的内部创建对象</span></div></li><li><div><span style="font-size: 16pt; font-family: Consolas;">向外部暴漏一个静态的公共方法</span></div></li></ul><div><span style="font-size: 16pt; font-family: Consolas;">代码如下：</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">class</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton{</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    //</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">构造器私有化</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(){}</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    //</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">本类内部创建对象实例</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private final static</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">=</span> <span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">new</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton()</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    //</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">提供一个静态方法，返回对象实例</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    public static</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">getInstance</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(){</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">        return</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">}</span></div><div><span style="font-size: 16pt; font-family: Consolas;">优缺点：</span></div><ul><li><div><span style="font-size: 16pt; font-family: Consolas;">优点：这种写法比较简单，就是在类装载时就完成了实例化，避免了线程同步的问题。</span></div></li><li><div><span style="font-size: 16pt; font-family: Consolas;">缺点：在类装载时就完成了实例化，没有达成Lazy Loading的效果。如果从始至终未使用这个实例，则会造成内存的浪费。</span></div></li><li><div><span style="font-size: 16pt; font-family: Consolas;">这种方式基于classloder机制避免了多线程的同步问题，不过，instance在类装载时就实例化，在单例模式中大多数都是调用getInstance方法，但是导致类装载的原因有多种，因此不能确定有其他的方式导致装载，这时候初始化instance就没有起到lazy loading的效果。</span></div></li></ul><div><span style="font-size: 16pt;"><br/></span></div><hr/><div><font style="font-size: 16pt;"><br/></font></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">（2）饿汉式（静态代码块）：</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">class</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton{</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><br/></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private static</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    //</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">在静态代码块中创建单例对象</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    static</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">{</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">        instance</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">=</span> <span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">new</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton()</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    //</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">私有化构造器</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(){}</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    //</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">提供一个静态方法，返回对象实例</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    public static</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">getInstance</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(){</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">         return</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">}</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><br/></div><div><br/></div><div><br/></div><hr/><div><font style="font-size: 16pt;"><br/></font></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">（3）懒汉式（线程不安全）</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">class</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton{</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(){}</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private static</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    public static</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">getInstance</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(){</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    if</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(</span><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">==</span> <span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">null</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">){</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">        instance</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">=</span> <span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">new</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton()</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">        }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">        return</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">}</span></div><div><span style="font-size: 16pt; font-family: Consolas;">优缺点：起到懒加载的效果，但是只能在单线程中使用；</span></div><div><span style="font-size: 16pt; font-family: Consolas;">如果在多线程下，一个线程进入了if（singleton == null）判断语句块，还未来得及往下执行，另一个线程也通过了这个判断语句，这时便会产生多个实例，所以在多线程下不要使用这种方法。</span></div><div><span style="font-size: 16pt; font-family: Consolas;">结论：在实际开发中，不要使用这种方法。</span></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><hr/><div><font style="font-size: 16pt;"><br/></font></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">（4）懒汉式（线程安全，同步方法）：</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">class</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton{</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(){}</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private static</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    //</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">加入了同步处理的代码，解决线程安全问题</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    public static synchronized</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">getInstance</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(){</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    if</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(</span><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">==</span> <span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">null</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">){</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">        instance</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">=</span> <span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">new</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton()</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">        }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">        return</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">}</span></div><div><span style="font-size: 16pt; font-family: Consolas;">优缺点：解决了线程不安全的问题</span></div><div><span style="font-size: 16pt; font-family: Consolas;">效率太低，每个线程再想获得类的实例的时候，执行getInstance（）方法都要进行同步，而其实这个方法只执行一次实例化代码就够了，后面的想获得该实例直接return就行了，方法进行同步效率太低。</span></div><div><span style="font-size: 16pt; font-family: Consolas;">结论：在实际开发中，不推荐使用。</span></div><div><span style="font-size: 16pt;"><br/></span></div><hr/><div><font style="font-size: 16pt;"><br/></font></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">（5）懒汉式（线程不安全，同步代码块）：</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">class</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton {</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">() { }</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private static</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    //</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">加入了同步处理的代码，解决线程安全问题</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    public static</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">getInstance</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">() {</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    if</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(</span><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">==</span> <span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">null</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">) {</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">        synchronized</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(Singleton.</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">this</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">) {</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">            instance</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">=</span> <span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">new</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton()</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">        }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    return</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">}</span></div><div><span style="font-size: 16pt; font-family: Consolas;">优缺点：这种方式本意是想对懒汉式（同步方法）实现方式的改进，因为前面同步方法效率太低，改为同步产生实例化的代码块。</span></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">但是这种同步并不能起到线程同步的作用，跟</span><span style="font-size: 16pt; font-family: Consolas;">懒汉式（线程不安全）实现方式遇到的情形是一致的。</span></div><div><span style="font-size: 16pt; font-family: Consolas;">结论：在实际开发中不能使用。</span></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><hr/><div><font style="font-size: 16pt;"><br/></font></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">（6）双重检查：</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">class</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton {</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">     private</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">() { }</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    //</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">添加关键字</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">volatile</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private static volatile</span><span style="font-size: 15pt;">  </span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    //</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">加入了同步处理的代码，解决线程安全问题</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    public static</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">getInstance</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">() {</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">        if</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(</span><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">==</span> <span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">null</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">) {</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">            synchronized</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(Singleton.</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">class</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">) {</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">                 if</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(</span><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">==</span> <span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">null</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">){</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">                       instance</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">=</span> <span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">new</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton()</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">                  }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">             }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">         }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">         return</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">instance</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">}</span></div><div><span style="font-size: 16pt; font-family: Consolas;">优缺点：double-check概念是多线程开发中常使用到的。如代码所示，我们进行了两次if检查，这样就保证了线程安全。</span></div><div><span style="font-size: 16pt; font-family: Consolas;">这样，实例化代码只用执行一次，后面再次访问时，判断if，直接返回return、实例化对象，也避免了反复的进行方法同步。</span></div><div><span style="font-size: 16pt; font-family: Consolas;">线程安全，延迟加载，效率较高</span></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">结论：在实际开发中，推荐使用这种单例设计模式。</span></div><div><font style="font-size: 16pt;"><br/></font></div><hr/><div><font color="#FF0000" style="font-size: 16pt;"><br/></font></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">（7）静态内部类：</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">class</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton {</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">() { }</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    //</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">使用静态内部类，外部类装载时内部类不装载，当调用</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">getInstance</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">时，该内部类被加载，实例被创建。</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private static class</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">SingletonInstance{</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">        private static final</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">INSTANCE</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">=</span> <span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">new</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton()</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    }</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    //</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">调用</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">getInstance</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">直接返回成员变量</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">SingletonInstance.INSTANCE</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    public static</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">getInstance</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">() {</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">        return</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">SingletonInstance.</span><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">INSTANCE</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">}</span></div><div><span style="font-size: 16pt; font-family: Consolas;">优缺点：这种方式采用了</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">类装载的机制保证初始化实例时只有一个线程。</span></div><div><span style="font-size: 16pt; font-family: Consolas;">静态内部类方式在singleton类加载时并不会立即被实例化，而是在需要实例化时，调用getInstance方法，才会装载SingletonInstance类，从而完成singleton的实例化。</span></div><div><span style="font-size: 16pt; font-family: Consolas;">类的静态属性只会在第一次加载类的时候初始化，所以在这里，JVM帮助我们保证了线程的安全性，<span style="font-size: 16pt; font-family: Consolas; color: rgb(255, 0, 0);">在类进行初始化时，别的线程是无法进入的。</span></span></div><div><span style="font-size: 16pt; font-family: Consolas;">避免了线程不安全，利用静态内部类特点实现延迟加载，效率高。</span></div><div><span style="font-size: 16pt;"><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">结论：推荐使用。</span></span></div><div><span style="font-size: 16pt;"><br/></span></div><hr/><div><font color="#FF0000" style="font-size: 16pt;"><br/></font></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">（8）枚举：</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">enum</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Singleton{</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">    INSTANCE</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;//属性</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    public void</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">method</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(){</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">        System.</span><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">out</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">.println(</span><span style="font-size: 15pt; color: rgb(106, 135, 89); font-family: &quot;Source Code Pro Medium&quot;, monospace;">&quot;hello&quot;</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">)</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">}</span></div><div><span style="font-size: 16pt; font-family: Consolas;">优缺点：借助JDk1.5加入的枚举来实现单例模式。不仅能避免多线程同步问题，而且还能防止反序列化重新创建新的对象。</span></div><div><span style="font-size: 16pt; font-family: Consolas;">这种方式是Effective java 作者Josh Bloch提倡的方法。</span></div><div><span style="font-size: 16pt; font-family: Consolas;">具体的</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace;">//</span><span style="font-size: 15pt; color: rgb(1, 128, 28); font-family: 宋体, monospace;">枚举的方式</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">class</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Resource{</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">     public void</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">smoe</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(){</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">            System.</span><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">out</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">.println(</span><span style="font-size: 15pt; color: rgb(106, 135, 89); font-family: &quot;Source Code Pro Medium&quot;, monospace;">&quot;hello</span> <span style="font-size: 15pt; color: rgb(106, 135, 89); font-family: 宋体, monospace;">单例</span><span style="font-size: 15pt; color: rgb(106, 135, 89); font-family: &quot;Source Code Pro Medium&quot;, monospace;">&quot;</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">)</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">     }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;"> }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">enum</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">SomeThing{</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-style: italic;">    INSTANCE</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    private</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Resource</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace;">instance</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    SomeThing</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">(){</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace;">        instance</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">=</span> <span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">new</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Resource()</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><br/></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    public</span> <span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">Resource</span> <span style="font-size: 15pt; color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace;">getInstance</span><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">() {</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">        return</span> <span style="font-size: 15pt; color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace;">instance</span><span style="font-size: 15pt; color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">    }</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="font-size: 15pt; color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace;">}</span></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">结论：推荐使用。</span></div><div><span style="font-size: 16pt;"><br/></span></div><hr/><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><span style="font-size: 16pt; font-family: Consolas;">单例模式在JDK应用的源码分析：</span></div><div><span style="font-size: 16pt; font-family: Consolas;">例如：JDK中，java.lang.Runtime就是经典的单例模式</span></div><div><span style="font-size: 16pt; font-family: Consolas;">饿汉式。</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">public class</span> <span style="color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">Runtime {</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">private static</span> <span style="color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">Runtime</span> <span style="color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt; font-style: italic;">currentRuntime</span> <span style="color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">=</span> <span style="color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">new</span> <span style="color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">Runtime()</span><span style="color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><br/></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt; font-style: italic;">/**</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt; font-style: italic;">* Returns the runtime object associated with the current Java application.</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt; font-style: italic;">* Most of the methods of class &lt;code&gt;Runtime&lt;/code&gt; are instance</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt; font-style: italic;">* methods and must be invoked with respect to the current runtime object.</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt; font-style: italic;">*</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt; font-style: italic;">*</span> <span style="color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt; font-style: italic; font-weight: bold;">@return</span> <span style="color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt; font-style: italic;">the &lt;code&gt;Runtime&lt;/code&gt; object associated with the current</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt; font-style: italic;">* Java application.</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt; font-style: italic;">*/</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">public static</span> <span style="color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">Runtime</span> <span style="color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">getRuntime</span><span style="color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">() {</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">return</span> <span style="color: rgb(152, 118, 170); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt; font-style: italic;">currentRuntime</span><span style="color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">;</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">}</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><br/></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(1, 128, 28); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt; font-style: italic;">/** Don't let anyone else instantiate this class */</span></div><div style="background-color: rgb(43, 43, 43); font-size: 15pt;"><span style="color: rgb(204, 120, 50); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">private</span> <span style="color: rgb(255, 198, 109); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">Runtime</span><span style="color: rgb(169, 183, 198); font-family: &quot;Source Code Pro Medium&quot;, monospace; font-size: 15pt;">() {}</span></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><hr/><div><span style="font-size: 16pt; font-family: Consolas;">单例模式注意事项和细节说明</span></div><ul><li><div><span style="font-size: 16pt; font-family: Consolas;">单例模式保证了系统内存中该类只存在一个对象，节省了系统的资源，对于一些需要频繁创建销毁的对象，使用单例模式提高性能。</span></div></li><li><div><span style="font-size: 16pt; font-family: Consolas;">当想实例化一个单例类的时候，必须要记住使用相应的获取对象的方法，而不是使用new；</span></div></li><li><div><span style="font-size: 16pt; font-family: Consolas;">单例模式使用的场景：</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">需要频繁的进行创建和销毁对象</span><span style="font-size: 16pt; font-family: Consolas;">、创建对象时耗时过多或耗费资源过多（即重量级对象）、经常用到的对象、</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">工具类对象、</span><span style="font-size: 16pt; font-family: Consolas;">频繁访问数据库或文件的对象（比如</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: Consolas;">数据源、session工厂</span><span style="font-size: 16pt; font-family: Consolas;">等</span><span style="font-size: 16pt; font-family: Consolas;">）</span></div></li></ul><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><font face="Consolas" style="font-size: 16pt;"><br/></font></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 